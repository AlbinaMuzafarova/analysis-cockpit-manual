

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11. Typical Pitfalls &mdash; ASGARD Analysis Cockpit Manual  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="12. FAQs" href="faqs.html" />
    <link rel="prev" title="10. API" href="api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ASGARD Analysis Cockpit Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">2. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">3. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick-setup-guide.html">4. Quick Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="first-steps.html">5. First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-concepts.html">6. Basic Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">7. Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="baselining-best-practices.html">8. Baselining Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="case-management-best-practices.html">9. Case Management Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">10. API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">11. Typical Pitfalls</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#certificate-validation-failed">11.1. Certificate Validation Failed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#log-file-import-of-previous-years">11.2. Log File Import of Previous Years</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elasticsearch-index-locked-due-to-low-free-disk-space">11.3. ElasticSearch Index Locked Due to Low Free Disk Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debug-failed-file-imports">11.4. Debug Failed File Imports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fixing-a-broken-proxy-configuration">11.5. Fixing a Broken Proxy Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#broken-before-analysis-cockpit-installation">11.5.1. Broken before Analysis Cockpit Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#broken-after-the-analysis-cockpit-installation">11.5.2. Broken after the Analysis Cockpit Installation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">12. FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">13. Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ASGARD Analysis Cockpit Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>11. Typical Pitfalls</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/usage/typical-pitfalls.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="typical-pitfalls">
<h1>11. Typical Pitfalls<a class="headerlink" href="#typical-pitfalls" title="Permalink to this headline">¶</a></h1>
<div class="section" id="certificate-validation-failed">
<h2>11.1. Certificate Validation Failed<a class="headerlink" href="#certificate-validation-failed" title="Permalink to this headline">¶</a></h2>
<p>If you receive the following error, SSL/TLS interception interrupted the
installation process.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>nextron@analysis3:~$ sudo nextronInstaller -cockpit
[sudo] Passwort für nextron:
Ign:1 https://update3.nextron-systems.com analysis InRelease
Err:2 https://update3.nextron-systems.com analysis Release
Certificate verification failed: The certificate is NOT trusted. The certificate issuer is unknown. Could not handshake: Error in the certificate verification. [IP: 192.168.3.21 8080]
</pre></div>
</div>
<p>Since we do not support setups in which the connections to our update
servers are intercepted (see Requirements chapter in this manual), the
only way to resolve this problem is to deactivate SSL/TLS interception
for our update servers.</p>
</div>
<div class="section" id="log-file-import-of-previous-years">
<h2>11.2. Log File Import of Previous Years<a class="headerlink" href="#log-file-import-of-previous-years" title="Permalink to this headline">¶</a></h2>
<p>The log file format of (old) THOR scan logs is the original SYSLOG
format, which contains no year value in the timestamp of the message
header.</p>
<p>You can modify the timestamp of old THOR logs by using the following
script:</p>
<p><a class="reference external" href="https://github.com/NextronSystems/nextron-helper-scripts/blob/master/asgard-analysis-cockpit/thor-timestamp-coverter.py">https://github.com/NextronSystems/nextron-helper-scripts/blob/master/asgard-analysis-cockpit/thor-timestamp-coverter.py</a></p>
</div>
<div class="section" id="elasticsearch-index-locked-due-to-low-free-disk-space">
<h2>11.3. ElasticSearch Index Locked Due to Low Free Disk Space<a class="headerlink" href="#elasticsearch-index-locked-due-to-low-free-disk-space" title="Permalink to this headline">¶</a></h2>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Mar</span> <span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">09</span> <span class="n">analysis</span><span class="o">-</span><span class="n">cockpit</span><span class="p">[</span><span class="mi">22732</span><span class="p">]:</span> <span class="p">[</span><span class="n">ERROR</span><span class="p">]</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">update</span> <span class="n">log</span><span class="p">:</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">update</span> <span class="n">logs</span><span class="p">:</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">update</span> <span class="n">documents</span><span class="p">:</span> <span class="n">http</span> <span class="n">status</span> <span class="mi">403</span> <span class="p">({</span><span class="s2">&quot;took&quot;</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="s2">&quot;timed\_out&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span><span class="s2">&quot;total&quot;</span><span class="p">:</span><span class="mi">136</span><span class="p">,</span><span class="s2">&quot;updated&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;deleted&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;batches&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;version\_conflicts&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;noops&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;retries&quot;</span><span class="p">:{</span><span class="s2">&quot;bulk&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;search&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span><span class="s2">&quot;throttled\_millis&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;requests\_per\_second&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="s2">&quot;throttled\_until\_millis&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;failures&quot;</span><span class="p">:[{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span><span class="s2">&quot;logs-2019-03-21&quot;</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;L11527716281914854515&quot;</span><span class="p">,</span><span class="s2">&quot;cause&quot;</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;cluster\_block\_exception&quot;</span><span class="p">,</span><span class="s2">&quot;reason&quot;</span><span class="p">:</span><span class="s2">&quot;blocked by: [FORBIDDEN/12/index read-only / allow delete (api)];&quot;</span><span class="p">},</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="mi">403</span><span class="p">},{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span><span class="s2">&quot;logs-2019-03-21&quot;</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;L12526619521231613944&quot;</span><span class="p">,</span><span class="s2">&quot;cause&quot;</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;cluster\_block\_exception&quot;</span><span class="p">,</span><span class="s2">&quot;reason&quot;</span><span class="p">:</span><span class="s2">&quot;blocked by: [FORBIDDEN/12/index read-only / allow delete (api)];&quot;</span><span class="p">},</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="mi">403</span><span class="p">},{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span><span class="s2">&quot;logs-2019-03-21&quot;</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;L10726191995274581682&quot;</span><span class="p">,</span><span class="s2">&quot;cause&quot;</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;cluster\_block\_exception&quot;</span><span class="p">,</span><span class="s2">&quot;reason&quot;</span><span class="p">:</span><span class="s2">&quot;blocked by: [FORBIDDEN/12/index read-only / allow delete (api)];&quot;</span><span class="p">},</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="mi">403</span><span class="p">},{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span><span class="s2">&quot;logs-2019-03-21&quot;</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;L17340155165061572392&quot;</span><span class="p">,</span><span class="s2">&quot;cause&quot;</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;cluster\_block\_exception&quot;</span><span class="p">,</span><span class="s2">&quot;reason&quot;</span><span class="p">:</span><span class="s2">&quot;blocked by: [FORBIDDEN/12/index read-only / allow delete (api)];&quot;</span><span class="p">},</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="mi">403</span><span class="p">},{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span><span class="s2">&quot;logs-2019-03-21&quot;</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;L10064611600393832220&quot;</span><span class="p">,</span><span class="s2">&quot;cause&quot;</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;cluster\_block\_exception&quot;</span><span class="p">,</span><span class="s2">&quot;reason&quot;</span><span class="p">:</span><span class="s2">&quot;blocked by: [FORBIDDEN/12/index read-only / allow delete (api)];&quot;</span><span class="p">},</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="mi">403</span><span class="p">}</span>
</pre></div>
</div>
<p>This happens when Elasticsearch thinks the disk is running low on space
so it puts itself into read-only mode.</p>
<p>By default, Elasticsearch’s decision is based on the percentage of disk
space that’s free, so on big disks this can happen even if you have many
gigabytes of free space.</p>
<p>The flood stage watermark is 95% by default, so on a 1TB drive you need
at least 50GB of free space or Elasticsearch will put itself into
read-only mode.</p>
<p>You can fix that issue with the following command using the command line
on ASGARD:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">9200</span><span class="o">/</span>\<span class="n">_all</span><span class="o">/</span>\<span class="n">_settings</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;index.blocks.read\_only\_allow\_delete&quot;: null}&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="debug-failed-file-imports">
<h2>11.4. Debug Failed File Imports<a class="headerlink" href="#debug-failed-file-imports" title="Permalink to this headline">¶</a></h2>
<p>Check for reported problems using this command:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">nextron</span><span class="o">/</span><span class="n">analysiscockpit3</span><span class="o">/</span><span class="n">events</span> <span class="o">-</span><span class="n">name</span> <span class="s2">&quot;\*.problem&quot;</span>
</pre></div>
</div>
<p>Make sure that you’re able to see the imported log data and review the
selected time range in the time range picker in whatever view you’re
reviewing the data. Be aware that the log data gets indexed with the
creation timestamp of the log lines not the time of their import.</p>
<p>This means that if you’re importing log data that is old, the default
date range set in the date range picker may be too narrowly defined so
that you’re just unable to see the imported data.</p>
</div>
<div class="section" id="fixing-a-broken-proxy-configuration">
<h2>11.5. Fixing a Broken Proxy Configuration<a class="headerlink" href="#fixing-a-broken-proxy-configuration" title="Permalink to this headline">¶</a></h2>
<p>Sometimes during installation, proxy settings get mixed up or a typo in
the proxy URL leads to a broken Internet connection.</p>
<p>It is not trivial to fix this situation, since the proxy settings
collected during installation are changed in so many different locations
on a Linux system for all the different services and command line tools.</p>
<div class="section" id="broken-before-analysis-cockpit-installation">
<h3>11.5.1. Broken before Analysis Cockpit Installation<a class="headerlink" href="#broken-before-analysis-cockpit-installation" title="Permalink to this headline">¶</a></h3>
<p>If you’ve set a wrong proxy before the package installation using the
<strong>sudo nextronInstaller -cockpit</strong> command and the installer failed to
fetch the required packages from our update servers, perform the
following steps.</p>
<p>Fix the proxy string in the file <strong>/etc/apt/apt.conf.d/00proxy</strong></p>
<p>E.g.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">edit</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">apt</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">00</span><span class="n">proxy</span>
</pre></div>
</div>
<p>Then rerun the installer.</p>
</div>
<div class="section" id="broken-after-the-analysis-cockpit-installation">
<h3>11.5.2. Broken after the Analysis Cockpit Installation<a class="headerlink" href="#broken-after-the-analysis-cockpit-installation" title="Permalink to this headline">¶</a></h3>
<p>If your infrastructure has changed and you have to change the proxy
server somewhen later edit the proxy settings in the Web GUI.</p>
<p><code class="docutils literal notranslate"><span class="pre">Settings</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">System</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Proxy</span></code></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="faqs.html" class="btn btn-neutral float-right" title="12. FAQs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api.html" class="btn btn-neutral float-left" title="10. API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Nextron Systems GmbH

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>